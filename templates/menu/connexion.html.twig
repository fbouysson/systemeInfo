<!DOCTYPE html>
<html lang="fr">
<link rel="stylesheet" href="{{asset('css/bootstrap.css')}}">
<link rel="stylesheet" href="{{asset('css/bootstrap-grid.css')}}">
<link rel="stylesheet" href="{{asset('css/bootstrap-reboot.css')}}">
<link rel="stylesheet" href="{{asset('css/connexion.css')}}">
<link rel="shortcut icon" type="image/x-icon" href="{{ asset('img/onglet.png') }}" />
<head>
    <meta charset="UTF-8"/>
    <title>UCO : connexion</title>
</head>
<body>
<div class="main">
    <h1>Ultimate Chat Online</h1>
    <div>
        <label for="username">Nom d'utilisateur</label>
        <input id="username" type="text" class="styl"/>
    </div>

    <div>
        <label for="mdp">Mot de passe</label>
        <input id="mdp" type="password" class="styl"/>
    </div>

    <div>
        <button class="btn btn-primary" onclick="connexion()" style="position: absolute; left: 30%">Connexion</button>
        <button class="btn btn-light" onclick="window.location = '{{ asset('inscription') }}'" style="position: absolute; right: 30%">Inscription</button>
    </div>
</div>

    <div id="alert" class="toast" role="alert" aria-live="assertive" aria-atomic="true" style="margin: 10px">
        <div class="toast-header">
            <strong class="mr-auto" style="font-size: 12px">Erreur de connexion !</strong>
            <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="toast-body" style="font-size: 12px; background-color: dimgrey;">
            Nom d'utilisateur ou mot de passe incorrect.
        </div>
    </div>
</body>

    <script type="text/javascript" src="{{asset('js/util.min.js')}}"></script>
    <script type="text/javascript" src="{{asset('js/jQuery.min.js')}}"></script>
    <script type="text/javascript" src="{{asset('js/bootstrap.js')}}"></script>
    <script type="text/javascript" src="{{asset('js/bootstrap.bundle.js')}}"></script>
    <script type="text/javascript">

        $(document).ready(function () {
            $('.toast').toast({
                //delay: 2000
                autohide: false
            });
        });

        let inputs = $('input');
        /** Code By Webdevtrick ( https://webdevtrick.com )  **/
        inputs.on('focusin', function() {
            $(this).parent().find('label').addClass('active');
        });

        inputs.on('focusout', function() {
            if (!this.value) {
                $(this).parent().find('label').removeClass('active');
            }
        });

        /** Code By Webdevtrick ( https://webdevtrick.com )  **/
        inputs.on('focusin', function() {
            $(this).parent().find('label').addClass('active');
        });

        inputs.on('focusout', function() {
            if (!this.value) {
                $(this).parent().find('label').removeClass('active');
            }
        });
        
        function connexion() {
            $('#alert').toast("hide");
            let username = document.getElementById("username");
            let mdp = document.getElementById("mdp");

            let Route = '{{ path('connexion') }}';
            $.ajax({
                url : Route,
                type : 'POST',
                data : "username=" + username.value +
                        "&mdp=" + mdp.value,
                dataType : 'json',
                
                success: function (json) {
                    let data = $.parseJSON(json);
                    if(data) {
                        window.location = "{{ asset('menu') }}";
                    }else{
                        $('#alert').toast("show");
                    }
                }
            });
        }
    </script>
</html>
